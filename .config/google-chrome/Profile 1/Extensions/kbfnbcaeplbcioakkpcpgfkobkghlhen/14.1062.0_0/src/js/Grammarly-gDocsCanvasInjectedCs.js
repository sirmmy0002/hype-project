!function(){function e(e){return new Promise((t=>setTimeout(t,e)))}function t(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),resolve:e,reject:t}}class n extends Error{}function r(e){return new Promise(((t,r)=>setTimeout((()=>r(new n("Promise timed out."))),e)))}Error;async function o(t,n,r){const a=r();if(!(t>0))return a;try{return await a}catch(a){return await e(n),o(t-1,n,r)}}var a;!function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}e.create=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(a||(a={}));void 0!==self.requestIdleCallback&&self.requestIdleCallback;function i(e){return e.nodeType===Node.ELEMENT_NODE}var s,c,l,u,g;!function(e){e[e.Escape=27]="Escape",e[e.Return=13]="Return",e[e.Tab=9]="Tab",e[e.RightArrow=39]="RightArrow",e[e.UpArrow=38]="UpArrow",e[e.DownArrow=40]="DownArrow"}(s||(s={})),function(e){e.editorElementClass="kix-appview-editor",e.layoutRootClass="kix-zoomdocumentplugin-outer",e.contentRootClass="kix-paginateddocumentplugin",e.wordNodeClass="kix-wordhtmlgenerator-word-node",e.commentContainerClass="docos-input",e.viewModeIconClass="docs-icon-acl-view-only-on-brand-color-background",e.eventsIFrameSelector=".docs-texteventtarget-iframe",e.selectionOverlaySelector=".kix-selection-overlay",e.cursor=".kix-cursor",e.cursor_rectangle=".kix-cursor-caret",e.cursor_active="docs-text-ui-cursor-blink",e.versionHistorySidebarSelector="#docs-revisions-sidebar",e.viewModeMenuSelector=".docs-toolbar-menu-button .docs-icon-acl-view-only",e.requestEditAccessButtonSelector="#titlebar-mode-indicator-container .kix-titlebar-request-access-button",e.lineViewDecorationsSelector=".kix-lineview-decorations",e.suggestionNewTextSelector='[class*="suggestion-text"]',e.suggestionOverlaySelector=".suggest-changes-top-colorbar",e.smartComposeSelector=".docs-smartcompose-suggestion",e.canvasSelector="canvas.kix-canvas-tile-content",e.canvasLayoutRootClass="kix-rotatingtilemanager",e.canvasLayoutContentSelector=".kix-rotatingtilemanager-content",e.canvasPageSVGSelector="div.kix-canvas-tile-content svg",e.canvasPageSVGSelectionSelector="div.kix-canvas-tile-content.kix-canvas-tile-selection svg",e.canvasPageSelector=".kix-page-paginated",e.canvasCompactLayoutClass="kix-page-canvas-compact-mode"}(c||(c={})),function(e){e.gdocsPageClass="kix-page",e.gdocsColumnClass="kix-page-column",e.gdocsColumnBottomClass="kix-page-column-bottom",e.gdocsFootNoteClass="kix-paginated-footnoteview",e.gdocsParagraphClass="kix-paragraphrenderer",e.gdocsTableClass="kix-tablerenderer",e.gdocsTableCellClass="kix-cellrenderer",e.lineTextClass="kix-lineview-text-block",e.wordNodeClass="kix-wordhtmlgenerator-word-node",e.inlineBlockClass="goog-inline-block",e.personEntityViewClass="kix-person-entity-view",e.personEntityNameClass="kix-person-entity-name",e.gdocsContentParagraphSelector=`.${e.gdocsColumnClass} .${e.gdocsParagraphClass}`,e.isContinuationParagraphContent=e=>{if(e){const t=e.closest(".kix-paragraphrenderer");return t&&!t.hasAttribute("id")}return null},e.isSplitTailParagraph=e=>i(e)&&!e.hasAttribute("id")}(l||(l={})),function(e){e.lineViewSelector="div.kix-lineview",e.spellingOverlaySelector="div.kix-spelling-error-overlay-container.kix-htmloverlay.docs-ui-unprintable",e.spellingUnderlineSelector="svg.kix-spelling-error-overlay",e.spellingBubbleSelector="div.kix-spell-bubble",e.spellingHighlightSelectors=["div.kix-spelling-error-highlighted-overlay","div.kix-spelling-error-highlighted-overlay-non-critical"],e.sellingUnderlinePromoBubbleSelector="div.jfk-bubble.jfk-bubble-promo.docs-promo-bubble"}(u||(u={})),function(e){function t(e){return i(e)&&e.classList.contains(l.gdocsParagraphClass)}function n(e){return i(e)&&e.classList.contains(l.gdocsTableClass)}e.isPage=function(e){return i(e)&&e.classList.contains(l.gdocsPageClass)},e.isPageLoaded=function(e){return e.querySelectorAll(l.gdocsContentParagraphSelector).length>0},e.isColumn=function(e){return i(e)&&e.classList.contains(l.gdocsColumnClass)},e.isColumnBottom=function(e){return i(e)&&e.classList.contains(l.gdocsColumnBottomClass)},e.isFootNote=function(e){return i(e)&&e.classList.contains(l.gdocsFootNoteClass)},e.isParagraph=t,e.isTable=n,e.isTableRow=function(e){return i(e)&&"tr"===e.tagName.toLowerCase()},e.isTableCellHolder=function(e){return i(e)&&"td"===e.tagName.toLocaleLowerCase()},e.isTableCellContent=function(e){return i(e)&&e.classList.contains(l.gdocsTableCellClass)},e.isContent=function(e){return t(e)||n(e)},e.isParagraphLine=function(e){return i(e)&&e.classList.contains(l.lineTextClass)},e.isWordNode=function(e){return i(e)&&e.classList.contains(l.wordNodeClass)},e.isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},e.isNBSPNode=function(e){return i(e)&&e.classList.contains(l.inlineBlockClass)&&e.textContent===String.fromCharCode(160)},e.isPersonEntityView=function(e){return i(e)&&e.classList.contains(l.personEntityViewClass)},e.isPersonEntityName=function(e){return i(e)&&e.classList.contains(l.personEntityNameClass)}}(g||(g={}));class d{constructor(e,t,n,r){this._customInboundEventName=t,this._customOutboundEventName=n,this._wrapOutboundMessage=r,this.inbound={subscribe:e=>{const t=({detail:t})=>{const n=t;e&&("function"==typeof e?e(n):e.next&&e.next(n))};return this._target.addEventListener(this._customInboundEventName,t,!1),{unsubscribe:()=>this._target.removeEventListener(this._customInboundEventName,t,!1)}}},this.outbound=e=>{const t=this._wrapOutboundMessage?this._wrapOutboundMessage(e):e,n=new CustomEvent(this._customOutboundEventName,{bubbles:!0,cancelable:!0,detail:t});this._target.dispatchEvent(n)},this._target=e.defaultView||e}}const p=new Set(["version","title","lang","translate","dir","dataset","hidden","tabIndex","accessKey","draggable","spellcheck","contentEditable","isContentEditable","offsetParent","offsetTop","offsetLeft","offsetWidth","offsetHeight","style","innerText","outerText","onabort","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting","onwheel","ongotpointercapture","onlostpointercapture","onpointerdown","onpointermove","onpointerup","onpointercancel","onpointerover","onpointerout","onpointerenter","onpointerleave","click","focus","blur","onauxclick","nonce","namespaceURI","prefix","localName","tagName","id","className","classList","slot","attributes","shadowRoot","assignedSlot","innerHTML","outerHTML","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientTop","clientLeft","clientWidth","clientHeight","onbeforecopy","onbeforecut","onbeforepaste","oncopy","oncut","onpaste","onsearch","onselectstart","previousElementSibling","nextElementSibling","children","firstElementChild","lastElementChild","childElementCount","onwebkitfullscreenchange","onwebkitfullscreenerror","setPointerCapture","releasePointerCapture","hasPointerCapture","hasAttributes","getAttributeNames","getAttribute","getAttributeNS","setAttribute","setAttributeNS","removeAttribute","removeAttributeNS","hasAttribute","hasAttributeNS","getAttributeNode","getAttributeNodeNS","setAttributeNode","setAttributeNodeNS","removeAttributeNode","closest","matches","webkitMatchesSelector","attachShadow","getElementsByTagName","getElementsByTagNameNS","getElementsByClassName","insertAdjacentElement","insertAdjacentText","insertAdjacentHTML","requestPointerLock","getClientRects","getBoundingClientRect","scrollIntoView","scrollIntoViewIfNeeded","createShadowRoot","getDestinationInsertionPoints","animate","remove","querySelector","querySelectorAll","webkitRequestFullScreen","webkitRequestFullscreen","scroll","scrollTo","scrollBy","before","after","replaceWith","prepend","append","ELEMENT_NODE","ATTRIBUTE_NODE","TEXT_NODE","CDATA_SECTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","PROCESSING_INSTRUCTION_NODE","COMMENT_NODE","DOCUMENT_NODE","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","NOTATION_NODE","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_PRECEDING","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","nodeType","nodeName","baseURI","isConnected","ownerDocument","parentNode","parentElement","childNodes","firstChild","lastChild","previousSibling","nextSibling","nodeValue","textContent","hasChildNodes","getRootNode","normalize","cloneNode","isEqualNode","isSameNode","compareDocumentPosition","contains","lookupPrefix","lookupNamespaceURI","isDefaultNamespace","insertBefore","appendChild","replaceChild","removeChild","addEventListener","removeEventListener","dispatchEvent"]),h=["autocorrect","comment","composing_decoration","composing_region","draft_comment","ignore_spellcheck","ignore_word","import_warnings","link","named_range","revision_diff","smart_todo","spellcheck","suppress_feature","text","voice_corrections","voice_dotted_span","autogen","cell","citation_sources","column_sector","date_time","document","equation","equation_function","footnote","headings","horizontal_rule","language","list","paragraph","row","tbl"],f=[61439,61438,59651,26,30,59649,3,59653,59652,16,17],m=[47,91,61439,61438,59651,26,30,59649,3,59653,59652,16,17,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),""),v=[47,91,28,3,59653,59651,26,25,31,92,110,18,16,93,47,103].reduce(((e,t)=>e+String.fromCharCode(t)),"");function b(e,t,n){return{call(r,o,a,i){var s;const c=i(a),l=null===(s=t.postFn)||void 0===s?void 0:s[o];if(l)try{l(r,e,a,c)}catch(e){n.logException(`proxy.call.${String(o)}`,e)}return c},set(r,o,a,i){var s;const c=null===(s=t.overrideSet)||void 0===s?void 0:s[o];if(c)try{const t=c(r,e,a);if(void 0!==t)return i(t)}catch(e){n.logException(`proxy.set.${String(o)}`,e)}return i(a)}}}const y="M",x=" ";function w(e){const t=/^(?:([\d\w]+) )?(?:(\w+) )?([\d\.]+)px (?:[\'\"])?([\w \-]+)(?:[\'\"])?$/.exec(e);if(t){const[e,n,r,o,a]=t;let i="400",s="normal";return n&&(isNaN(parseInt(n,10))?"italic"===n?(s="italic",i=isNaN(parseInt(r,10))?"bold"===r?"700":"400":r):i="bold"===n?"700":"400":(i=n,s=r||s)),`${i} ${s} ${parseFloat(o).toFixed(4)}px "${a}"`}return e}var C,S;function P(e){return e.type===C.text}function _(e,t,n){const r=new DOMPoint(e,t).matrixTransform(n);return{left:r.x,top:r.y}}function N(e,t,n){return{width:n.a*e+n.c*t,height:n.b*e+n.d*t}}function E(e,t){return t.a*e}function T(e,t){return t.d*e}function k(e,t,n,r,o=!1){const a=(e,t,n,r=!1)=>{e.beginPath(),e.strokeStyle=`rgba(0,0,255,${r?.05:.2})`,e.lineWidth=2,e.moveTo(t,n),e.lineTo(t,n-20),e.stroke()};e.save(),e.resetTransform(),a(e,t,n,o),r.forEach((r=>a(e,t+r,n,o))),e.restore()}!function(e){e.text="text",e.space="space",e.lineBreak="lineBreak",e.footnoteLink="footnoteLink",e.mention="mention"}(C||(C={})),function(e){e.ordinary="ordinary",e.special="special"}(S||(S={}));const A=(e,t,n,r,o,a=0,i=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(221,0,0,${i?.05:.1})`,e.fillRect(t,n,r,10),e.fillStyle=`rgba(221,0,0,${i?.4:.8})`,e.font="10px Arial",e.fillText(`${a}`,t,n+10),e.fillStyle=`rgba(0,128,221,${i?.4:.8})`,k(e,t,n,o,i),e.restore()},M=(e,t,n,r,o,a=!1)=>{e.save(),e.resetTransform(),e.fillStyle=`rgba(0,221,0,${a?.05:.1})`,e.fillRect(t,n+10,r,10),e.restore(),k(e,t,n,o,a)},O=(e,t,n,r=!1)=>{e.save(),e.resetTransform(),e.beginPath(),e.strokeStyle=`rgba(0,221,0,${r?.05:.1})`,e.lineWidth=5,e.moveTo(t+2.5,n),e.lineTo(t+2.5,n+10),e.lineTo(t-10,n+10),e.stroke(),e.restore()},R=["#ffffff","rgba(255,255,255,1)"];function I(e){if(e.compact)return 0;const{clips:t}=e.savableState;if(1===t.length){if(!e.currentPageMap)return 0;return L(t[0],{...e.currentPageMap.pageAttrs.canvasBitmapSize,left:0,top:0})}if(2===t.length){const[e,n]=t;return L(n,e)}return 0}function L(e,t){return e.left!==t.left||e.width!==t.width?0:0===e.top&&e.height<.6666666666666666*t.height?1:e.top>t.top&&e.top>.6666666666666666*t.height?2:0}function D(e){const t=e.getCurrentPageAttrs();if(e.currentSelection=[],e.matchingBroken=!1,e.hasSuggestions=!1,e.footnote={footnoteLineDetected:!1},e.compact=e.isCompactLayout(),e.clearedRect&&function(e,t){const{left:n,top:r,width:o,height:a}=t,i=e;return!(n<=0&&r<=0&&n+o>=i.width&&r+a>=i.height)}(t.canvasBitmapSize,e.clearedRect)){e.currentPageMap=null;const n={rect:null,fragments:[],wordCount:0};e.currentPartialMap={pageAttrs:t,rect:e.clearedRect,sections:{main:n}},e.savableState.renderContainer=e.currentPageFragment={type:"page",pageAttrs:t,partialRect:e.clearedRect,fragments:[],isCompactLayout:e.compact}}else e.currentPartialMap=null,e.currentPageMap=(n=t,{pageAttrs:{...n},sections:{main:{rect:null,fragments:[],wordCount:0},header:{rect:null,fragments:[],wordCount:0},footer:{rect:null,fragments:[],wordCount:0},footnotes:{rect:null,fragments:[],wordCount:0}}}),e.savableState.renderContainer=e.currentPageFragment={type:"page",pageAttrs:t,fragments:[],isCompactLayout:e.compact};var n}function F(e,t,n,r){const o=n.metricsMap.getMetrics(t,y),a=n.metricsMap.getMetrics(t,x);if(!o||!a)return null;return{spaceMetrics:a,top:e.top-T(o.chunk.actualBoundingBoxAscent,r),height:T(o.chunk.actualBoundingBoxAscent+o.chunk.actualBoundingBoxDescent,r)}}function B(e,t,n,{top:r,height:o},a,i){const s=i.metricsMap.getMetrics(t,e);if(!s)return null;const c=E(s.chunk.width,a);return{baseline:n.top,top:r,left:n.left,text:e,width:c,height:o,charShifts:s.charShifts.map((e=>E(e.width,a)))}}function z(e,t,n,r,o,a,i){const s=new RegExp(`^${String.fromCodePoint(8237)}.*${String.fromCodePoint(8236)}$`).test(e),c=/^\d+$/.test(W(e)),l=!s&&!c,u=F(n,t,o,a);if(l)return!0;if(c){const s=W(e);if(i&&u&&P(i)){let e=i,c=r.fragments.length-1;for(let t=r.fragments.length-1;t>0;t--){const o=r.fragments[t];if(o.type===C.lineBreak)break;if(!(o.left>n.left)){e=o,c=t;break}}const l=Math.abs(e.height*$-u.height)<q*u.height,g=Math.abs(e.top-u.top)<u.height*q;if(l&&g){const i=B(s,t,n,u,a,o);if(i){const t={...i,height:e.height,baseline:e.baseline,type:C.footnoteLink,class:S.ordinary,linkText:s,text:"#"};if(function(e){return e.type===C.space}(e)&&function(e,t,n=.001){return e===t||Math.abs(e-t)<=n}(e.left,n.left,U))return!function(e,t,n=.001){return function(e,t,n=.001){return e>=t||e+n>=t}(t,e,n)}(e.width,i.width,U)?r.fragments.splice(c,1,t,{...e,left:e.left+i.width,width:e.width-i.width}):r.fragments.splice(c,1,t),!0;if(Math.abs(i.left-e.left-e.width)<.5*u.spaceMetrics.chunk.width)return r.fragments.splice(c+1,0,t),!0}}}}else if(s&&i&&u&&P(i)){const s=Math.abs(i.height*$-u.height)<q*u.height,c=Math.abs(i.top-u.top)<u.height*q;if(s&&c){const s=B(W(e),t,n,u,a,o);if(s){if(Math.abs(s.left-i.left-i.width)<.5*u.spaceMetrics.chunk.width)return r.fragments.push({...s,height:i.height,baseline:i.baseline,type:C.text,class:S.ordinary}),!0}}}return!1}const j=1,$=.6,q=.1,U=.001,V=192,G=[String.fromCharCode(8204)],H=new RegExp(`[${G.join("")}]`,"g");function W(e){return(8237===e.codePointAt(0)?e.substr(1,e.length-2)||"":e).replace(H,"")}function Y(e,t,n,r,o,a){var i,s;const c=a.getTransform(),l=_(t,n,c),u=w(null!==(i=o.savableState.font)&&void 0!==i?i:a.font),g=W(e);o.savableState.renderContainer&&g&&o.savableState.renderContainer.fragments.push({type:"text",style:u,text:g,baseline:l.top,left:l.left,scaleX:c.a,scaleY:c.d});const d=r.fragments.length>0?r.fragments[r.fragments.length-1]:null;if(z(e,u,l,r,o,c,d))return;const p=d&&((h=d).type===C.text||h.type===C.footnoteLink)?d:null;var h;if(p){const e={top:p.baseline,left:p.left},t=l.left-e.left-p.width,n=o.lastTextClipsId!==o.savableState.clipsId||l.top-e.top>.2*p.height;!n&&t>j&&(r.fragments.push({type:C.space,class:S.ordinary,baseline:l.top,left:e.left+p.width,top:p.top,width:t,height:p.height}),o.debugVizualize&&M(a,e.left+p.width,l.top,t,[])),n&&(r.fragments.push({type:C.lineBreak,class:S.ordinary,baseline:l.top,left:e.left+p.width,top:p.top,height:p.height}),o.debugVizualize&&O(a,p.left+p.width,p.top))}o.lastTextClipsId=o.savableState.clipsId;const f=F(l,u,o,c);if(!f)return;const m=null!==(s=g.match(/[^\s]+|\s+/g))&&void 0!==s?s:[];for(const e of m){const t=B(e,u,l,f,c,o);if(null==t)continue;const n={type:C.text,class:S.ordinary,...t};r.fragments.push(n),o.debugVizualize&&(e.match(/^\s+$/)?M(a,l.left,l.top,n.width,n.charShifts):A(a,l.left,l.top,t.width,t.charShifts," "===e?void 0:r.wordCount++)),l.left+=n.width}}const Q={postFn:{fillText(e,t,[n,r,o,a]){const i=function(e,t){if(e.currentPartialMap)return e.currentPartialMap.sections.main;if(!e.currentPageMap)return null;const n=e.currentPageMap.sections,r=e.footnote.footnoteLineDetected&&t>e.footnote.footnoteLinePosition.top?e.currentPageMap.sections.footnotes:e.currentPageMap.sections.main;if(e.compact)return r;switch(I(e)){case 1:return n.header;case 2:return n.footer;default:return r}}(t,o);if(!i)return void function(e,t){!e.currentPageMap&&!e.currentPartialMap&&e.api.log(t,"Current page map expected")}(t,"proxy.fillText");const s=i.fragments.length>0;Y(n,r,o,i,t,e),!s&&i.fragments.length>0&&(i.rect=Z(t))},fillRect(e,t,[n,r,o,a]){if(["rgba(118, 167, 250, 0.5)","rgba(118, 167, 250, 0.501960784313726)"].includes(e.fillStyle)){const i=e.getTransform();t.currentSelection.push({..._(n,r,i),...N(o,a,i)})}1===t.saveCount&&null===t.currentPageFragment&&"string"==typeof e.fillStyle&&R.includes(e.fillStyle)&&!t.savableState.clips.length&&(t.clearedRect=K(e,[n,r,o,a]))},clearRect(e,t,n){t.savableState.clips.length||(t.clearedRect=K(e,n))},scale(e,t){1===t.saveCount&&null===t.currentPageFragment&&null!==t.clearedRect&&D(t)},save(e,t){t.saveCount++,t.savedState.push({...t.savableState})},restore(e,t){const n=t.savedState.pop();if(n&&(t.savableState=n),t.saveCount--,0===t.saveCount)if(t.hasSuggestions&&t.onChangeMode("suggest"),t.currentPageMap&&t.currentPageFragment){const e=t.currentPageMap.pageAttrs,n=t.currentPageMap.sections,r=n.footer.rect?Math.min(e.canvasBitmapSize.height,n.footer.rect.top):e.canvasBitmapSize.height,a=t.footnote.footnoteLineDetected?t.footnote.footnoteLinePosition.top:r;n.footnotes.rect={top:a,left:0,width:e.canvasBitmapSize.width,height:r-a};const i=n.header.rect?Math.max(0,n.header.rect.top+n.header.rect.height):0;n.main.rect={top:i,left:0,width:e.canvasBitmapSize.width,height:a-i},t.onRender({pageMap:(o=t.currentPageMap,{pageAttrs:o.pageAttrs,sections:{main:J(o.sections.main),footnotes:J(o.sections.footnotes),header:J(o.sections.header),footer:J(o.sections.footer)}}),pageAttrs:e,selection:t.currentSelection,hasSuggestions:t.hasSuggestions,pageFragment:t.currentPageFragment}),t.currentPageFragment=null,t.currentPageMap=null,t.currentSelection=[],t.clearedRect=null}else t.currentPartialMap&&t.currentPageFragment&&(t.onRender({partialPageMap:(r=t.currentPartialMap,{pageAttrs:r.pageAttrs,rect:r.rect,sections:{main:J(r.sections.main)}}),pageAttrs:t.currentPartialMap.pageAttrs,selection:t.currentSelection,hasSuggestions:t.hasSuggestions,pageFragment:t.currentPageFragment}),t.currentPageFragment=null,t.currentPartialMap=null,t.currentSelection=[],t.clearedRect=null);var r,o},moveTo(e,t,[n,r]){t.footnote.footnoteLineDetected||(t.footnote.lastPosition={left:n,top:r})},lineTo(e,t,[n,r]){!function(e,t,n){if(!e.footnote.footnoteLineDetected){const r=e.footnote.lastPosition;if(r){const o=t-r.left;n>0&&Math.abs(r.top-n)<j&&o===V&&(e.footnote={footnoteLineDetected:!0,footnoteLinePosition:r},e.savableState.renderContainer&&e.savableState.renderContainer.fragments.push({type:"footnote_line",y:n}))}}e.footnote.footnoteLineDetected||(e.footnote.lastPosition={left:t,top:n})}(t,n,r)},beginPath(e,t){t.path=[]},clip(e,t,n){var r,o,a,i;if(n[0])t.api.logError("proxy.clip:unexpectedArguments","clip with parameters is not supported");else if(1!==t.path.length)t.api.logError("proxy.clip:unsupportedPath","clip with multiple paths is not supported",{pathSize:t.path.length});else{if(t.savableState.clips=[...t.savableState.clips,t.path[0]],t.savableState.renderContainer){const e={type:"clip",rect:t.path[0],fragments:[]};t.savableState.renderContainer.fragments.push(e),t.savableState.renderContainer=e}if(t.currentPageMap){const e=null!==(o=null===(r=t.currentPageMap)||void 0===r?void 0:r.sections.header.fragments.length)&&void 0!==o&&o,n=null!==(i=null===(a=t.currentPageMap)||void 0===a?void 0:a.sections.footer.fragments.length)&&void 0!==i&&i;if(!e||!n)switch(I(t)){case 1:e||(t.currentPageMap.sections.header.rect=Z(t));break;case 2:n||(t.currentPageMap.sections.footer.rect=Z(t))}}}t.savableState.clipsId=++t.lastClipsId},rect(e,t,n){t.path.push(K(e,n))}},overrideSet:{strokeStyle:(e,t,n)=>"rgba(221,0,0,1)"===n||"rgba(66,133,244,1)"===n?"rgba(0,0,0,0)":void("rgba(19,115,51,0.7)"===n&&(t.hasSuggestions=!0)),fillStyle:(e,t,n)=>"rgba(252,232,230,1)"===n||"rgba(232,240,254,1)"===n?"rgba(0,0,0,0)":void("rgba(31,161,93,1)"===n&&(t.hasSuggestions=!0)),font(e,t,n){t.savableState.font=n}}},X={overrideSet:{strokeStyle:(e,t,n)=>"rgba(221,0,0,1)"===n||"rgba(66,133,244,1)"===n?"rgba(0,0,0,0)":void 0}};function K(e,[t,n,r,o]){const a=e.getTransform();return{..._(t,n,a),...N(r,o,a)}}function J(e){const{wordCount:t,...n}=e;return n}function Z(e){return e.savableState.clips.reduce(((e,t)=>e?function(e,t){const n=Math.max(e.left,t.left),r=Math.max(e.top,t.top),o=Math.min(e.left+e.width,t.left+t.width),a=Math.min(e.top+e.height,t.top+t.height);return{left:n,top:r,width:n>o?0:o-n,height:r>a?0:a-r}}(e,t):t),null)}class ee extends Error{constructor(e){super(`Assertion failed: ${e?"string"==typeof e?e:e():"(unnamed)"}`)}}function te(e,t){if(!e)throw new ee(t)}function ne(e,t){if(null==e)throw new ee((()=>t?`Expected ${t} to be non-null`:"Expected non-null"));return e}function re(e,t){return{get:()=>t.reduce(((e,t)=>null==e?void 0:e[t]),e.get()),parent(){if(0!==t.length)return re(e,t.slice(0,-1))},getPath:()=>[e,t]}}function oe(e,t,n){const r=e.get();if(!r)return[void 0,void 0,void 0];const o=ae(r,t,n);if(!o.results.length)return[void 0,void 0,void 0];const a=o.results.map((t=>re(e,t.path)));return[a[0],o.results[0].value,a]}function ae(e,t,n,r=Object.getOwnPropertyNames(e)){const o=new Set,a=[];let i=0;const s=(r,c,l,u=0)=>{if(i++,"prototype"===r||c instanceof Window)return;if(u>n)return;const g=[...l,r];try{if(t(r,c))return void a.push({path:g,value:c})}catch(e){}var d;if(null!=c&&!o.has(c))if(o.add(c),Array.isArray(c))c.forEach(((e,t)=>{try{s(t.toString(),e,g,u+1)}catch(e){}}));else if(c instanceof Object){((d=c)&&null!==d&&1===d.nodeType&&"string"==typeof d.nodeName?Object.getOwnPropertyNames(e).filter((e=>!p.has(e))):Object.getOwnPropertyNames(c)).forEach((e=>{try{s(e,c[e],g,u+1)}catch(e){}}))}};return r.forEach((t=>{try{s(t,e[t],[])}catch(e){}})),{results:a,iterations:i}}function ie(e){const t=ne(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=ne(e[t],"kixApp"),r=function(e,t){const n=new Set;return e.filter((e=>{const r=t(e);return!n.has(r)&&(n.add(r),!0)}))}(ae(n,((e,t)=>t&&""===t.toString().charAt(0)),5).results,(e=>e.value)).filter((e=>isNaN(parseInt(e.path[e.path.length-1],10)))).reduce(((e,r)=>{const o=r.path.slice(0,r.path.length-1).reduce(((e,t)=>e[t]),n),a=ae(o,((e,t)=>t instanceof RegExp),1);let i=!1,s=!1;if(1===a.results.length){const e=a.results[0].value;i=e.toString()===v,s=e.toString()===m}else{1===ae(o,((e,t)=>Array.isArray(t)&&t.length===f.length&&t.every(((e,t)=>e.charCodeAt(0)===f[t]))),1).results.length&&(s=!0)}return i?{...e,headersAndFooters:[t].concat(r.path)}:s?{...e,text:[t].concat(r.path)}:e}),{text:[],headersAndFooters:[]});return 0===r.text.length?null:r}function se(e,t,n){return e.push(Array.isArray(t)||isNaN(t)?n:t),e}class ce{constructor(e){this._win=e,this._result=null,this._resizer=null,this._kixApp=function(e){const t=ne(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp"))));return re((n=e,{get:()=>n}),[t]);var n}(this._win),this._images=function(e){let t,n=0;const r=()=>{n++,t=e()};return{get calcCount(){return n},refresh:r,get:()=>(0===n&&r(),t)}}((()=>function(e){const t="inline",n="positioned";try{const[r]=oe(e,((e,r)=>(e===t||e===n)&&"object"==typeof r),5);te(!!r);const o=r.parent();te(!!o);const[a,i]=oe(r,((e,t)=>"object"==typeof t&&!!t&&2===Object.keys(t).length),5);te(!!a&&!!i);const s=ne(Object.keys(i)[0]),[c,l]=ne(a.getPath());return{inline:re(o,[t,...l,s]),positioned:re(o,[n,...l,s])}}catch(e){return{inline:null,positioned:null,error:e}}}(this._kixApp)))}_attemptTextExtraction(){try{const e=ie(this._win),t=Boolean(null==e?void 0:e.headersAndFooters.length),n=function(e){const t=ne(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),n=ae(ne(e[t],"kixApp"),((e,t)=>"horizontal_rule"===e&&2===Object.keys(t).length),6);return[t].concat(ne(n.results[0]).path,Object.keys(n.results[0].value)[0])}(this._win);let r=!1;this._images.refresh();const o=(null==e?void 0:e.text)||[],a=o.pop(),i=o.reduce(((e,t)=>e[t]),this._win),s=(null==e?void 0:e.headersAndFooters)||[],c=s.pop(),l=s.reduce(((e,t)=>e[t]),this._win),u=null==n?void 0:n.pop(),g=n?null==n?void 0:n.reduce(((e,t)=>e[t]),this._win):{};if(o.length>0){const{suggestionsFullArrayPath:e}=function(e,t){try{const n=ne(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp")))),r=ae(ne(e[n],"kixApp"),((e,t)=>t&&Array.isArray(t)&&t.some((e=>Array.isArray(e)&&-1!==e.toString().indexOf("suggest.")))),10).results.filter((e=>e.path[0]===t[1])).filter((e=>!h.some((t=>e.path.includes(t))))).map((e=>{const t=[...e.path];return t.pop(),t})).reduce(((t,r)=>{const o=[n].concat(r).reduce(((e,t)=>e[t]),e);return t?o[t.idProp]>t.id?{...t,id:o[t.idProp],path:r}:t:Object.getOwnPropertyNames(o).reduce(((e,t)=>Array.isArray(o[t])||isNaN(parseInt(o[t],10))?Array.isArray(o[t][0])?{...e,fullArrayProp:t}:{...e,compactArrayProp:t}:{...e,idProp:t,id:o[t]}),{path:r})}),null);return{suggestionsFullArrayPath:r?[n].concat(r.path,r.fullArrayProp):null}}catch(e){return{suggestionsFullArrayPath:null}}}(this._win,o),n=Array.isArray(e)&&e.pop(),s=e&&e.reduce(((e,t)=>e[t]),this._win),d=e=>{const t=null==e?void 0:e.get();return Array.isArray(t)?t.reduce(se,[]):[]};return{getText:()=>{const e=i[a],o=t?l[c]:"",p=g[u],h=Array.isArray(p)?p.reduce(se,[]).sort(((e,t)=>e-t)):[],f=d(this._images.get().positioned);let m=d(this._images.get().inline);r||(m.length>0?r=!0:this._images.calcCount<10&&"string"==typeof e&&e.indexOf("*")>=0&&(this._images.refresh(),m=d(this._images.get().inline),r=m.length>0));const v=s&&n&&s[n];if("string"==typeof e)return v?{fullText:e,headersAndFootersText:o,ignoredRanges:[...v].reduce(((e,t)=>(e.push(Array.isArray(t)?!!t[0]:!!e.length&&e[e.length-1]),e)),[]),nonTextEntities:{horizontal_rule:{startsAt:h,textRepresentation:"-\n"},inline_image:{startsAt:m,textRepresentation:"*"},positioned_image:{startsAt:f,textRepresentation:"\n"}}}:{fullText:e,headersAndFootersText:o,ignoredRanges:[],nonTextEntities:{horizontal_rule:{startsAt:h,textRepresentation:"-\n"},inline_image:{startsAt:m,textRepresentation:"*"},positioned_image:{startsAt:f,textRepresentation:"\n"}}};throw new Error("unexpected text value type")},gotIgnoredRanges:!!s}}return{error:"notFound"}}catch(e){return{error:"exception",message:e.message}}}_attemptResizerExtraction(){const e=function(e){try{return[ne(Object.getOwnPropertyNames(e).find((e=>-1!==e.toString().indexOf("_kixApp"))))].concat("resize")}catch(e){return null}}(this._win);try{return e?e.reduce(((e,t)=>e[t]),this._win):()=>{}}catch(e){return()=>{}}}_getText(e){try{return this._result||(this._result=this._attemptTextExtraction()),e.reQueryForIgnoredRanges&&"getText"in this._result&&!this._result.gotIgnoredRanges&&(this._result=this._attemptTextExtraction()),"getText"in this._result?this._result.getText():null}catch(e){return null}}getText(e){return this._getText(e)}triggerRender(){try{this._resizer||(this._resizer=this._attemptResizerExtraction()),this._resizer()}catch(e){}}}function le(e,t,n){let r;function o(o,a){const i=(void 0===r&&(r=null!==(s=t())&&void 0!==s?s:null,r||n.logError("createMeasuringFallbackMetricsMap","Can't create self-measuring canvas")),r);var s;if(!i)return;n.log("createMeasuringFallbackMetricsMap","No metrics for text"),i.font=o,i.measureText(a);const c=e.getMetrics(o,a);return c||n.logError("createMeasuringFallbackMetricsMap","Self-measuring failed for text"),c}return{get size(){return e.size},getMetrics(t,n){var r;return null!==(r=e.getMetrics(t,n))&&void 0!==r?r:o(t,n)},getFontMetrics(t){const n=e.getFontMetrics(t);return{get size(){return n.size},getMetrics(e){var r;return null!==(r=n.getMetrics(e))&&void 0!==r?r:o(t,e)}}}}}var ue;!function(n){class r extends Error{constructor(e,t=1e3){super(`SafePromiseError: ${e}`),this.stack=(super.stack||"").slice(t)}}function o(e){return e.catch((e=>e instanceof Error&&!e.stack?Promise.reject(new r(e.message)):Promise.reject(e)))}n.fromPromise=o,n.fromAsync=function(e){return(...t)=>o(e(...t))},n.noop=n.fromPromise(Promise.resolve()),n.create=function(e){return o(new Promise(e))},n.sync=function(e){return o(new Promise(((t,n)=>t(e()))))},n.createCompletionSource=t,n.delay=e}(ue||(ue={}));class ge{constructor(e,t){this._transport=e,this._log=t,this._calls=new Map,this._sub=this._transport.inbound.subscribe((e=>{var t;const n=this._calls.get(e.id);if(n)try{"err"in e?n.reject(e.err):n.resolve(e.res)}finally{this._calls.delete(e.id)}else null===(t=this._log)||void 0===t||t.warn(`received rpc call response for unregistered call ${e.id}`)})),this.api=new Proxy({},{get:(e,t)=>"then"===t?void 0:(...e)=>this._handleCall(t,e)})}_handleCall(e,t){let n=a.create();for(;this._calls.has(n);)n=a.create();const r=ue.createCompletionSource();return this._calls.set(n,r),this._transport.outbound({id:n,method:e,args:t}),r.promise}dispose(){this._sub.unsubscribe()}}const de=(t,n,a)=>(i,s,l)=>{const u=()=>document.querySelector(`.${c.canvasLayoutRootClass}`);!async function(){var c;try{const g=null!==(c=u())&&void 0!==c?c:await async function(){for(;;){await e(250);const t=u();if(t)return t}}();if(!g)throw new Error("Cannot find rotating tile manager");const d=function(e,t){const n=new ce(self);let r,o=!1,a=!1,i=[];return{onChangeMode(e){r!==e&&(r=e,"suggest"===r&&(o=!1,a=!1,s(e)))},onRender(r){if(o||a){const o=a?null:n.getText({reQueryForIgnoredRanges:r.hasSuggestions});e.pageRendered({fullText:o,renderResult:r},t)}else i.push(r)},init:()=>s(void 0)};function s(r){setTimeout((()=>{if(o||a)return;if(r!=r)return;const s=n.getText({reQueryForIgnoredRanges:!0});null===s?(a=!0,e.logError("FullTextExtractor","Cannot get full document text")):o=!0,i.length?(Promise.resolve(i).then((async n=>{for(const r of n)await e.pageRendered({fullText:s,renderResult:r},t)})),i=[]):n.triggerRender()}),0)}}(t.api,n),p=le(s.metricsMap,(()=>document.createElement("canvas").getContext("2d")),t.api);i((e=>{if(function(e){return Boolean(e.className)}(e)){const n=function(e){return{...e,matchingBroken:!1,currentSelection:[],currentPageFragment:null,currentPageMap:null,currentPartialMap:null,saveCount:0,savedState:[],savableState:{clips:[],clipsId:0,font:void 0,renderContainer:null},path:[],lastClipsId:0,lastTextClipsId:0,clearedRect:null,hasSuggestions:!1,footnote:{footnoteLineDetected:!1},compact:!1}}({api:t.api,metricsMap:p,getCurrentPageAttrs(){const t=g.getBoundingClientRect(),{left:n,top:r,width:o,height:a}=e.getBoundingClientRect(),i={left:n-t.left,top:r-t.top,width:o,height:a};return{canvasBitmapSize:{width:e.width,height:e.height},pageOffsetRect:i}},isCompactLayout(){var t;return!!(null===(t=e.parentElement)||void 0===t?void 0:t.classList.contains("kix-page-canvas-compact-mode"))},onChangeMode:d.onChangeMode,onRender:d.onRender});return a?function({api:e,state:t}){return b(t,X,e)}({api:t.api,state:n}):function({api:e,state:t}){return b(t,Q,e)}({api:t.api,state:n})}}));await o(10,0,(()=>{return e=400,n=t.api.init(),Promise.race([r(e),n]);var e,n}))&&d.init(),a||(await e(1e3),s.metricsMap.size||await t.api.logError("init.textMeasuringCheck","No text measuring events received")),await async function(t,n){for(let r=0;r<60;r++){const r=document.querySelectorAll("canvas");if(r.length){const e=n();return void([...r].every((t=>e.includes(t)))||await t.api.logError("init.patchedCanvasesCheck","Not all the document canvases have been patched"))}await e(1e3)}await t.api.logError("init.patchedCanvasesCheck","No document canvases found after 60 seconds")}(t,l)}catch(e){try{await t.api.logException("init",e)}catch(e){}}}()};!async function(){var e,t;let n;try{const r=document.documentElement.dataset.grGdcConnId||(document.documentElement.dataset.grGdcConnId=`${Date.now()}-${Math.random()}`),{request:o,response:a}=function(e){return{request:`cs-grm-request-${e}`,response:`cs-grm-response-${e}`}}(r);n=new ge(new d(document,a,o)),n.api.log("injected.starting","Injected script initialization");const i=self[`GR_GDEI_${r}`];if(!i)return console.error("Could not start grammarly integration","no early injected data found"),void n.api.logError("injected.starting","No early injected data found");const s=(null===(e=document.currentScript)||void 0===e?void 0:e.getAttribute("data-ext-version"))||"unknown",c=Boolean(null===(t=document.currentScript)||void 0===t?void 0:t.getAttribute("data-ext-minimal"))||!1;de(n,s,c)(i.addMiddleware,i.textMeasuringState,i.getPatchedCanvases)}catch(e){console.error("Could not start grammarly integration","module not loaded",e),n&&n.api.logError("injected.startFail",`Injected init failed: ${String(e)}`)}}()}();